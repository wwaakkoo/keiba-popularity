# netkeiba 払い戻しデータ取得 Chrome拡張機能

netkeiba.comのレース結果ページから払い戻しデータを自動抽出し、競馬統計分析アプリ用のテキスト形式に変換するChrome拡張機能です。

## 機能

- netkeiba.comのレース結果ページから払い戻しデータを自動抽出
- 既存の競馬統計アプリ（index.html）の入力形式に自動変換
- ワンクリックでクリップボードにコピー

## インストール方法

### 1. 拡張機能を読み込む

1. Chromeを開いて、`chrome://extensions/` にアクセス
2. 右上の「デベロッパーモード」をONにする
3. 「パッケージ化されていない拡張機能を読み込む」をクリック
4. この `extension` フォルダを選択

### 2. アイコンの準備（初回のみ）

拡張機能のアイコンが必要です。以下のいずれかの方法で準備してください：

**方法A: 簡易的な方法**
- `icon16.png`, `icon48.png`, `icon128.png` という名前の画像ファイルを用意
- 適当な競馬関連の画像やシンプルなアイコンでOK
- サイズは16x16px, 48x48px, 128x128pxに調整

**方法B: オンラインツールで作成**
1. [https://www.favicon-generator.org/](https://www.favicon-generator.org/) などのサイトにアクセス
2. 好きな画像をアップロードして各サイズのアイコンを生成
3. 生成されたファイルを `extension` フォルダに配置

**方法C: 一時的にアイコンなしで使用**
- `manifest.json` から `icons` と `action.default_icon` のセクションを削除すればアイコンなしでも動作します

## 使い方

### 基本的な使い方

1. **netkeiba.comのレース結果ページを開く**
   - 例: `https://race.netkeiba.com/race/result.html?race_id=202508040501`

2. **拡張機能を起動**
   - Chromeツールバーの拡張機能アイコン（🏇マーク）をクリック
   - またはアドレスバー右側の拡張機能アイコンから選択

3. **データを取得**
   - ポップアップで「📊 データを取得」ボタンをクリック
   - 自動的にページから払い戻しデータが抽出されます

4. **データをコピー**
   - 変換されたテキストが表示されたら、「📋 クリップボードにコピー」をクリック

5. **統計アプリに貼り付け**
   - `index.html` を開いて、「払い戻しデータ」のテキストエリアに貼り付け

### 対応している券種

- 単勝
- 複勝
- 枠連
- 馬連
- ワイド
- 馬単
- 3連複
- 3連単

## 出力形式

以下のような形式で出力されます（既存アプリと互換性あり）：

```
1R
単勝
7
110
1人気
複勝
7
14
15
100
130
510
1人気
2人気
8人気
馬連
7 14
240
1人気
...
```

## トラブルシューティング

### データが取得できない

1. **netkeiba.comのレース結果ページか確認**
   - URLに `race.netkeiba.com/race/result.html` が含まれているか確認

2. **ページが完全に読み込まれているか確認**
   - ページの読み込みが完了してから拡張機能を実行

3. **コンソールでエラーを確認**
   - F12キーで開発者ツールを開く
   - Consoleタブでエラーメッセージを確認

### 変換されたデータの形式が正しくない

- netkeiba.comのHTML構造が変更された可能性があります
- `content.js` の修正が必要な場合があります
- GitHubのIssuesで報告してください

### 拡張機能が表示されない

1. `chrome://extensions/` で拡張機能が有効になっているか確認
2. 「デベロッパーモード」がONになっているか確認
3. エラーが表示されている場合は、該当ファイルを修正

## 制限事項

- **netkeiba.comのレース結果ページでのみ動作**します
- HTMLの構造変更により動作しなくなる可能性があります
- 1レースずつの取得です（12レース一括取得は今後の機能追加予定）

## 今後の機能追加予定

- [ ] 12レース分の一括取得
- [ ] レース結果データ（着順、馬名、人気）の同時取得
- [ ] 頭数データの自動取得
- [ ] データの検証機能
- [ ] エクスポート機能の強化

## ライセンス

このプロジェクトの一部です。個人利用のみを想定しています。

## 注意事項

- netkeiba.comの利用規約を遵守してください
- 過度なアクセスは避け、常識的な範囲でご利用ください
- このツールはあくまで手動操作を補助するものです
- 自動巡回・大量取得には使用しないでください
